# üéØ –°–∏—Å—Ç–µ–º–∞ –º–∞—à–∏–Ω–Ω–æ–≥–æ –Ω–∞–≤—á–∞–Ω–Ω—è –¥–ª—è Music Recommender

## üìã –û–≥–ª—è–¥

–ú–∏ —Å—Ç–≤–æ—Ä–∏–ª–∏ –æ–∫—Ä–µ–º—É –±–∞–∑—É –¥–∞–Ω–∏—Ö —Ç–∞ —Å–∏—Å—Ç–µ–º—É –¥–ª—è –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è ML –º–æ–¥–µ–ª–µ–π (KNN —Ç–∞ —ñ–Ω—à–∏—Ö –∞–ª–≥–æ—Ä–∏—Ç–º—ñ–≤) –¥–ª—è –º—É–∑–∏—á–Ω–∏—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ–π.

## üóÉÔ∏è –ù–æ–≤—ñ —Ç–∞–±–ª–∏—Ü—ñ –ë–î

### 1. `MLTrainingData` 
–û—Å–Ω–æ–≤–Ω–∞ —Ç–∞–±–ª–∏—Ü—è –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è —Ç—Ä–µ–Ω—É–≤–∞–ª—å–Ω–∏—Ö –¥–∞–Ω–∏—Ö:
- **–ê—É–¥—ñ–æ —Ñ—ñ—á—ñ**: Danceability, Energy, Valence, Tempo, Acousticness, —Ç–æ—â–æ
- **–ú–µ—Ç–∞–¥–∞–Ω—ñ**: Artist, Genre, ReleaseYear, ArtistPopularity  
- **–í–∑–∞—î–º–æ–¥—ñ—ó**: Rating, InteractionType, PlayCount, PlayDuration
- **–ö–æ–Ω—Ç–µ–∫—Å—Ç**: ListeningContext (morning/afternoon/evening/night), Timestamp
- **–ö–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫—ñ —Ñ—ñ—á—ñ**: UserAvgDanceability, UserAvgEnergy, —Ç–æ—â–æ

### 2. `MLModelMetrics`
–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è –º–æ–¥–µ–ª–µ–π:
- –ú–µ—Ç—Ä–∏–∫–∏ —è–∫–æ—Å—Ç—ñ: Accuracy, Precision, Recall, F1Score, MAE, MSE
- –î–∞–Ω—ñ –ø—Ä–æ —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è: TrainingSamples, TestSamples, UniqueUsers, UniqueTracks
- –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è: ModelConfig, FeatureImportance (JSON)

### 3. `MLUserProfiles`
ML –ø—Ä–æ—Ñ—ñ–ª—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤:
- **–ú—É–∑–∏—á–Ω—ñ –ø–µ—Ä–µ–≤–∞–≥–∏**: PreferredDanceability, PreferredEnergy, —Ç–æ—â–æ
- **–ü–æ–≤–µ–¥—ñ–Ω–∫–æ–≤—ñ –ø–∞—Ç–µ—Ä–Ω–∏**: SkipRate, RepeatRate, ExplorationRate
- **–†—ñ–∑–Ω–æ–º–∞–Ω—ñ—Ç–Ω—ñ—Å—Ç—å**: GenreDiversity, ArtistDiversity
- **–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü—ñ—è**: ClusterId –¥–ª—è —Å—Ö–æ–∂–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤

### 4. `TrackSimilarity`
–ö–µ—à —Å—Ö–æ–∂–æ—Å—Ç—ñ –º—ñ–∂ —Ç—Ä–µ–∫–∞–º–∏:
- CosineSimilarity, EuclideanDistance
- AudioSimilarity, GenreSimilarity

### 5. `UserSimilarity`  
–ö–µ—à —Å—Ö–æ–∂–æ—Å—Ç—ñ –º—ñ–∂ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏:
- CosineSimilarity, PearsonCorrelation, JaccardSimilarity
- CommonTracks (–∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å–ø—ñ–ª—å–Ω–∏—Ö —Ç—Ä–µ–∫—ñ–≤)

## üõ†Ô∏è –ù–æ–≤—ñ —Å–µ—Ä–≤—ñ—Å–∏

### `MLDataCollectionService`
–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –∑–±—ñ—Ä —Ç–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ç—Ä–µ–Ω—É–≤–∞–ª—å–Ω–∏—Ö –¥–∞–Ω–∏—Ö:
- –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫–∏—Ö –≤–∑–∞—î–º–æ–¥—ñ–π –≤ —Ç—Ä–µ–Ω—É–≤–∞–ª—å–Ω—ñ –¥–∞–Ω—ñ
- –û–±—á–∏—Å–ª–µ–Ω–Ω—è —Ä–µ–π—Ç–∏–Ω–≥—ñ–≤ –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ç–∏–ø—É –≤–∑–∞—î–º–æ–¥—ñ—ó —Ç–∞ —Ç—Ä–∏–≤–∞–ª–æ—Å—Ç—ñ –ø—Ä–æ—Å–ª—É—Ö–æ–≤—É–≤–∞–Ω–Ω—è
- –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è ML –ø—Ä–æ—Ñ—ñ–ª—ñ–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –∫–æ–Ω—Ç–µ–∫—Å—Ç—É –ø—Ä–æ—Å–ª—É—Ö–æ–≤—É–≤–∞–Ω–Ω—è

### `EnhancedDataLoader` (Python)
–ü–æ–∫—Ä–∞—â–µ–Ω–∏–π –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—á –¥–∞–Ω–∏—Ö –¥–ª—è ML:
- –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç—Ä–µ–Ω—É–≤–∞–ª—å–Ω–∏—Ö –¥–∞–Ω–∏—Ö –∑ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—î—é
- –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–∏—Ö –¥–ª—è content-based —Ç–∞ collaborative filtering
- –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –º–µ—Ç—Ä–∏–∫ –º–æ–¥–µ–ª–µ–π –≤ –ë–î
- –û—Ç—Ä–∏–º–∞–Ω–Ω—è —Ñ—ñ—á–µ–π —Ç—Ä–µ–∫—ñ–≤ –¥–ª—è –ø—Ä–µ–¥–∏–∫—Ü—ñ—ó

## üîó API Endpoints

### –ó–±—ñ—Ä —Ç—Ä–µ–Ω—É–≤–∞–ª—å–Ω–∏—Ö –¥–∞–Ω–∏—Ö
```
POST /api/MLTraining/collect-training-data
```
–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–±–∏—Ä–∞—î –Ω–æ–≤—ñ –≤–∑–∞—î–º–æ–¥—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —Ç–∞ –∫–æ–Ω–≤–µ—Ä—Ç—É—î —ó—Ö –≤ —Ç—Ä–µ–Ω—É–≤–∞–ª—å–Ω—ñ –¥–∞–Ω—ñ.

### –°—Ç–≤–æ—Ä–µ–Ω–Ω—è/–æ–Ω–æ–≤–ª–µ–Ω–Ω—è –ø—Ä–æ—Ñ—ñ–ª—é –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
```
POST /api/MLTraining/user-profile/{userId}
```
–°—Ç–≤–æ—Ä—é—î –∞–±–æ –æ–Ω–æ–≤–ª—é—î ML –ø—Ä–æ—Ñ—ñ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –π–æ–≥–æ –≤–∑–∞—î–º–æ–¥—ñ–π.

### –¢—Ä–µ–Ω—É–≤–∞–Ω–Ω—è –º–æ–¥–µ–ª–µ–π
```
POST /api/MLTraining/train-models
Content-Type: application/json

{
  "ModelTypes": ["content", "collaborative", "hybrid"],
  "MinInteractionsPerUser": 5,
  "IncludeSkips": false,
  "TimeWindowDays": 30
}
```

### ML —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó
```
GET /api/MLTraining/recommendations/{userId}?modelType=hybrid&limit=20
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç—Ä–µ–Ω—É–≤–∞–ª—å–Ω–∏—Ö –¥–∞–Ω–∏—Ö
```
GET /api/MLTraining/training-data/stats
```

### –û—á–∏—â–µ–Ω–Ω—è —Å—Ç–∞—Ä–∏—Ö –¥–∞–Ω–∏—Ö
```
DELETE /api/MLTraining/training-data/cleanup?maxAgeDays=365
```

### –°—Ç–∞—Ç—É—Å ML —Å–µ—Ä–≤—ñ—Å—É
```
GET /api/MLTraining/service/status
```

## üîß –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

### 1. –ó–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –º—ñ–≥—Ä–∞—Ü—ñ–π
```bash
dotnet ef database update
```

### 2. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
```bash
dotnet run
```

### 3. –ó–∞–ø—É—Å–∫ Python ML —Å–µ—Ä–≤—ñ—Å—É (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)
```bash
cd ml_service
python start_service.py
```

## üìä –Ø–∫ –ø—Ä–∞—Ü—é—î —Å–∏—Å—Ç–µ–º–∞

### 1. –ó–±—ñ—Ä –¥–∞–Ω–∏—Ö
- –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–∑–∞—î–º–æ–¥—ñ—î –∑ –º—É–∑–∏–∫–æ—é (–≥—Ä–∞—î, —Å–∫—ñ–ø–∞—î, –ª–∞–π–∫–∞—î)
- `UserSongInteraction` –∑–∞–ø–∏—Å—É—î—Ç—å—Å—è –≤ –ë–î
- `MLDataCollectionService` –∫–æ–Ω–≤–µ—Ä—Ç—É—î –≤–∑–∞—î–º–æ–¥—ñ—ó –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω—ñ —Ç—Ä–µ–Ω—É–≤–∞–ª—å–Ω—ñ –¥–∞–Ω—ñ

### 2. –û–±—á–∏—Å–ª–µ–Ω–Ω—è —Ä–µ–π—Ç–∏–Ω–≥—ñ–≤
–†–µ–π—Ç–∏–Ω–≥ –æ–±—á–∏—Å–ª—é—î—Ç—å—Å—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ:
- **–¢–∏–ø –≤–∑–∞—î–º–æ–¥—ñ—ó**: Liked (1.0), AddedToPlaylist (0.9), Played (0.6), Skipped (0.1)
- **–¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å –ø—Ä–æ—Å–ª—É—Ö–æ–≤—É–≤–∞–Ω–Ω—è**: –ú–µ–Ω—à–µ 10% = —Å–∫—ñ–ø, –±—ñ–ª—å—à–µ 80% = –¥–æ–±—Ä–µ
- **–î–æ–¥–∞—Ç–∫–æ–≤—ñ —Å–∏–≥–Ω–∞–ª–∏**: IsLiked, IsRepeat

### 3. –ü—Ä–æ—Ñ—ñ–ª—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
ML –ø—Ä–æ—Ñ—ñ–ª—å –º—ñ—Å—Ç–∏—Ç—å:
- **–ú—É–∑–∏—á–Ω—ñ –ø–µ—Ä–µ–≤–∞–≥–∏**: –°–µ—Ä–µ–¥–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –∞—É–¥—ñ–æ —Ñ—ñ—á–µ–π
- **–í–∞—Ä—ñ–∞–Ω—Å–∏**: –ù–∞—Å–∫—ñ–ª—å–∫–∏ —Ä—ñ–∑–Ω–æ–º–∞–Ω—ñ—Ç–Ω—ñ —Å–º–∞–∫–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- **–ü–æ–≤–µ–¥—ñ–Ω–∫–∞**: –°–∫—ñ–ª—å–∫–∏ —Å–∫—ñ–ø–∞—î, –ø–æ–≤—Ç–æ—Ä—é—î, –¥–æ—Å–ª—ñ–¥–∂—É—î –Ω–æ–≤—É –º—É–∑–∏–∫—É
- **–†—ñ–∑–Ω–æ–º–∞–Ω—ñ—Ç–Ω—ñ—Å—Ç—å**: –ñ–∞–Ω—Ä–æ–≤–∞ —Ç–∞ –∞—Ä—Ç–∏—Å—Ç–∏—á–Ω–∞ —Ä—ñ–∑–Ω–æ–º–∞–Ω—ñ—Ç–Ω—ñ—Å—Ç—å

### 4. –¢—Ä–µ–Ω—É–≤–∞–Ω–Ω—è –º–æ–¥–µ–ª–µ–π
- **Content-based**: Random Forest –Ω–∞ –∞—É–¥—ñ–æ —Ñ—ñ—á–∞—Ö + –∫–æ–Ω—Ç–µ–∫—Å—Ç
- **Collaborative**: KNN –Ω–∞ –º–∞—Ç—Ä–∏—Ü—ñ user-item
- **Hybrid**: –ö–æ–º–±—ñ–Ω–∞—Ü—ñ—è –æ–±–æ—Ö –ø—ñ–¥—Ö–æ–¥—ñ–≤

## üß™ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

–ó–∞–ø—É—Å—Ç—ñ—Ç—å —Ç–µ—Å—Ç–æ–≤–∏–π —Å–∫—Ä–∏–ø—Ç:
```bash
python test_ml_training_system.py
```

–ê–±–æ —Ç–µ—Å—Ç—É–π—Ç–µ API –≤—Ä—É—á–Ω—É:
```bash
# –ó–±—ñ—Ä —Ç—Ä–µ–Ω—É–≤–∞–ª—å–Ω–∏—Ö –¥–∞–Ω–∏—Ö
curl -X POST http://localhost:5000/api/MLTraining/collect-training-data

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
curl -X GET http://localhost:5000/api/MLTraining/training-data/stats

# –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø—Ä–æ—Ñ—ñ–ª—é –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
curl -X POST http://localhost:5000/api/MLTraining/user-profile/1
```

## üìà –ü–µ—Ä–µ–≤–∞–≥–∏ –Ω–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏

1. **–°—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω—ñ –¥–∞–Ω—ñ**: –û–∫—Ä–µ–º—ñ —Ç–∞–±–ª–∏—Ü—ñ –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö —Ç–∏–ø—ñ–≤ ML –¥–∞–Ω–∏—Ö
2. **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –∑–±—ñ—Ä —Ç–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ç—Ä–µ–Ω—É–≤–∞–ª—å–Ω–∏—Ö –¥–∞–Ω–∏—Ö
3. **–ú–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω—ñ—Å—Ç—å**: –Ü–Ω–¥–µ–∫—Å–∏ —Ç–∞ –æ–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω—ñ –∑–∞–ø–∏—Ç–∏ –¥–ª—è –≤–µ–ª–∏–∫–∏—Ö –æ–±—Å—è–≥—ñ–≤ –¥–∞–Ω–∏—Ö
4. **–ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥**: –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –º–µ—Ç—Ä–∏–∫ –º–æ–¥–µ–ª–µ–π –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ
5. **–ö–µ—à—É–≤–∞–Ω–Ω—è**: –ü–æ–ø–µ—Ä–µ–¥–Ω—å–æ –æ–±—á–∏—Å–ª–µ–Ω—ñ —Å—Ö–æ–∂–æ—Å—Ç—ñ –¥–ª—è —à–≤–∏–¥—à–∏—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ–π
6. **–ü—Ä–æ—Ñ—ñ–ª—é–≤–∞–Ω–Ω—è**: –î–µ—Ç–∞–ª—å–Ω—ñ –ø—Ä–æ—Ñ—ñ–ª—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª—ñ–∑–∞—Ü—ñ—ó

## üîÆ –ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏

1. –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ —ñ—Å–Ω—É—é—á–æ—é —Å–∏—Å—Ç–µ–º–æ—é —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ–π
2. –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è real-time –æ–Ω–æ–≤–ª–µ–Ω—å –ø—Ä–æ—Ñ—ñ–ª—ñ–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
3. A/B —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è —Ä—ñ–∑–Ω–∏—Ö –∞–ª–≥–æ—Ä–∏—Ç–º—ñ–≤
4. –î–æ–¥–∞–≤–∞–Ω–Ω—è –±—ñ–ª—å—à —Å–∫–ª–∞–¥–Ω–∏—Ö —Ñ—ñ—á–µ–π (—Å–µ–∑–æ–Ω–Ω—ñ—Å—Ç—å, –Ω–∞—Å—Ç—Ä—ñ–π, —Ç–æ—â–æ)
5. –í–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è deep learning –º–æ–¥–µ–ª–µ–π
6. –°–∏—Å—Ç–µ–º–∞ –∑–≤–æ—Ä–æ—Ç–Ω–æ–≥–æ –∑–≤'—è–∑–∫—É –¥–ª—è –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ–π 