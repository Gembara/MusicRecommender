# üéµ Music Recommender ML Service 2.0

–ü–æ—Ç—É–∂–Ω–∏–π Python ML —Å–µ—Ä–≤—ñ—Å –¥–ª—è –º—É–∑–∏—á–Ω–∏—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ–π –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∞—É–¥—ñ–æ —Ñ—ñ—á–µ–π —Ç–∞ –ø–æ–≤–µ–¥—ñ–Ω–∫–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤.

## üéØ –©–æ —Ä–æ–±–∏—Ç—å —Å–µ—Ä–≤—ñ—Å

### üìä –î–∞–Ω—ñ –¥–ª—è —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è
- **Features (—Ñ—ñ—á—ñ)**: –∞—É–¥—ñ–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –ø—ñ—Å–µ–Ω—å –∑ Spotify API
- **Labels (–º—ñ—Ç–∫–∏)**: –ø–æ–≤–µ–¥—ñ–Ω–∫–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (—Ä–µ–π—Ç–∏–Ω–≥–∏, –ª–∞–π–∫–∏, —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å –ø—Ä–æ—Å–ª—É—Ö–æ–≤—É–≤–∞–Ω–Ω—è)

### üéµ –ê—É–¥—ñ–æ —Ñ—ñ—á—ñ
```
üéµ Danceability - —Ç–∞–Ω—Ü—é–≤–∞–ª—å–Ω—ñ—Å—Ç—å (0-1)
‚ö° Energy - –µ–Ω–µ—Ä–≥—ñ—è (0-1)  
üòä Valence - –Ω–∞—Å—Ç—Ä—ñ–π (0-1)
ü•Å Tempo - —Ç–µ–º–ø (BPM, –Ω–æ—Ä–º–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–π)
üé∏ Acousticness - –∞–∫—É—Å—Ç–∏—á–Ω—ñ—Å—Ç—å (0-1)
üéº Instrumentalness - —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–ª—å–Ω—ñ—Å—Ç—å (0-1)
üó£Ô∏è Speechiness - –º–æ–≤–Ω—ñ—Å—Ç—å (0-1)
üîä Loudness - –≥—É—á–Ω—ñ—Å—Ç—å (dB, –Ω–æ—Ä–º–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–π)
üìà Popularity - –ø–æ–ø—É–ª—è—Ä–Ω—ñ—Å—Ç—å (0-100)
```

### üë§ –ü–æ–≤–µ–¥—ñ–Ω–∫–æ–≤—ñ –º—ñ—Ç–∫–∏
```
‚≠ê Rating - —Ä–µ–π—Ç–∏–Ω–≥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (1-5)
‚ù§Ô∏è IsLiked - —á–∏ –ø–æ–¥–æ–±–∞—î—Ç—å—Å—è —Ç—Ä–µ–∫
‚è±Ô∏è PlayDuration - —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å –ø—Ä–æ—Å–ª—É—Ö–æ–≤—É–≤–∞–Ω–Ω—è
‚è≠Ô∏è IsSkipped - —á–∏ –±—É–≤ –ø—Ä–æ–ø—É—â–µ–Ω–∏–π
```

## ü§ñ ML –ê–ª–≥–æ—Ä–∏—Ç–º–∏

### 1. Content-Based (–Ω–∞ –æ—Å–Ω–æ–≤—ñ –∫–æ–Ω—Ç–µ–Ω—Ç—É)
- **–ú–æ–¥–µ–ª—å**: Random Forest Regressor
- **–ü—Ä–∏–Ω—Ü–∏–ø**: –∞–Ω–∞–ª—ñ–∑—É—î –∞—É–¥—ñ–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —É–ª—é–±–ª–µ–Ω–∏—Ö —Ç—Ä–µ–∫—ñ–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –∑–Ω–∞—Ö–æ–¥–∏—Ç—å –Ω–æ–≤—ñ —Ç—Ä–µ–∫–∏ –∑ —Å—Ö–æ–∂–∏–º–∏ —Ñ—ñ—á–∞–º–∏

### 2. Collaborative Filtering (–∫–æ–ª–∞–±–æ—Ä–∞—Ç–∏–≤–Ω–∞ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è)
- **–ú–æ–¥–µ–ª—å**: K-Nearest Neighbors (KNN) –∑ cosine similarity
- **–ü—Ä–∏–Ω—Ü–∏–ø**: –∑–Ω–∞—Ö–æ–¥–∏—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –∑—ñ —Å—Ö–æ–∂–∏–º–∏ —Å–º–∞–∫–∞–º–∏
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: —Ä–µ–∫–æ–º–µ–Ω–¥—É—î —Ç—Ä–µ–∫–∏, —è–∫—ñ –ø–æ–¥–æ–±–∞–ª–∏—Å—å —Å—Ö–æ–∂–∏–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º

### 3. Hybrid (–≥—ñ–±—Ä–∏–¥–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥)
- **–ü—Ä–∏–Ω—Ü–∏–ø**: –∫–æ–º–±—ñ–Ω—É—î Content-Based (60%) + Collaborative (40%)
- **–ü–µ—Ä–µ–≤–∞–≥–∏**: –Ω–∞–π–∫—Ä–∞—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –±—ñ–ª—å—à–æ—Å—Ç—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤

## üöÄ –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤—ñ—Å—É

### –í–∏–º–æ–≥–∏
- Python 3.8+
- SQLite –±–∞–∑–∞ –¥–∞–Ω–∏—Ö –∑ –ø—Ä–æ–µ–∫—Ç—É MusicRecommender

### –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –∑–∞–ø—É—Å–∫
```bash
# –ü–µ—Ä–µ—Ö—ñ–¥ –≤ –ø–∞–ø–∫—É ML —Å–µ—Ä–≤—ñ—Å—É
cd ml_service

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –∑–∞–ø—É—Å–∫ (–≤—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ —Ç–∞ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤—ñ—Å)
python start_service.py

# –ê–±–æ —Ä—É—á–Ω–∏–π –∑–∞–ø—É—Å–∫
pip install -r requirements.txt
python main.py
```

### –î–æ—Å—Ç—É–ø –¥–æ —Å–µ—Ä–≤—ñ—Å—É
- **API**: http://localhost:8000
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è**: http://localhost:8000/docs
- **Health check**: http://localhost:8000/health

## üîß API Endpoints

### üìö –û—Å–Ω–æ–≤–Ω—ñ endpoint'–∏

#### `POST /train`
–¢—Ä–µ–Ω—É–≤–∞–Ω–Ω—è ML –º–æ–¥–µ–ª–µ–π –Ω–∞ –¥–∞–Ω–∏—Ö –∑ –±–∞–∑–∏
```json
{
  "success": true,
  "message": "‚úÖ –ú–æ–¥–µ–ª—ñ –Ω–∞—Ç—Ä–µ–Ω–æ–≤–∞–Ω–æ —É—Å–ø—ñ—à–Ω–æ!",
  "metrics": {
    "content_mse": 0.234,
    "content_mae": 0.156,
    "collaborative_sparsity": 0.892,
    "total_training_samples": 1500,
    "unique_users": 25,
    "unique_tracks": 200
  }
}
```

#### `POST /recommend/content`
Content-based —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó
```json
{
  "user_id": 1,
  "limit": 10
}
```

#### `POST /recommend/collaborative`  
Collaborative filtering —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó
```json
{
  "user_id": 1,
  "limit": 10
}
```

#### `POST /recommend/hybrid`
–ì—ñ–±—Ä–∏–¥–Ω—ñ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ)
```json
{
  "user_id": 1,
  "limit": 10
}
```

#### `GET /models/info`
–Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –Ω–∞—Ç—Ä–µ–Ω–æ–≤–∞–Ω—ñ –º–æ–¥–µ–ª—ñ —Ç–∞ –¥–∞–Ω—ñ

### üìã –ü—Ä–∏–∫–ª–∞–¥ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –∑ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è–º–∏
```json
[
  {
    "track_id": "4iV5W9uYEdYUVa79Axb7Rh",
    "artist": "The Weeknd",
    "predicted_rating": 4.67,
    "reason": "Content-Based: —Å—Ö–æ–∂—ñ –∞—É–¥—ñ–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏",
    "features": {
      "danceability": 0.679,
      "energy": 0.641,
      "valence": 0.486,
      "genre": "pop"
    }
  }
]
```

## üîç –Ø–∫ –ø—Ä–∞—Ü—é—î —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è

### 1. –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö
- –í–∑–∞—î–º–æ–¥—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –∑ `UserSongInteractions`
- –ê—É–¥—ñ–æ —Ñ—ñ—á—ñ –∑ `SongFeatures`
- –û–±'—î–¥–Ω–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö –∑–∞ `SpotifyTrackId`

### 2. –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ñ—ñ—á–µ–π
- –ù–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è `Tempo` —Ç–∞ `Loudness`
- –û—á–∏—â–µ–Ω–Ω—è –≤—ñ–¥ NaN –∑–Ω–∞—á–µ–Ω—å
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü—ñ—è —á–µ—Ä–µ–∑ `StandardScaler`

### 3. –¢—Ä–µ–Ω—É–≤–∞–Ω–Ω—è –º–æ–¥–µ–ª–µ–π
- **Content**: Random Forest –Ω–∞ –∞—É–¥—ñ–æ —Ñ—ñ—á–∞—Ö ‚Üí –ø—Ä–µ–¥–∏–∫—Ü—ñ—è —Ä–µ–π—Ç–∏–Ω–≥—É
- **Collaborative**: KNN –Ω–∞ user-item –º–∞—Ç—Ä–∏—Ü—ñ ‚Üí –ø–æ—à—É–∫ —Å—Ö–æ–∂–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤

### 4. –û—Ü—ñ–Ω–∫–∞ —è–∫–æ—Å—Ç—ñ
- MSE (Mean Squared Error) –¥–ª—è content-based –º–æ–¥–µ–ª—ñ
- –†–æ–∑—Ä—ñ–¥–∂–µ–Ω—ñ—Å—Ç—å –º–∞—Ç—Ä–∏—Ü—ñ –¥–ª—è collaborative –º–æ–¥–µ–ª—ñ
- Feature importance –¥–ª—è —Ä–æ–∑—É–º—ñ–Ω–Ω—è –≤–∞–∂–ª–∏–≤–æ—Å—Ç—ñ —Ñ—ñ—á–µ–π

## üõ†Ô∏è –¢–µ—Ö–Ω—ñ—á–Ω—ñ –¥–µ—Ç–∞–ª—ñ

### –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞
```
‚îú‚îÄ‚îÄ data_loader.py     # –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–∏—Ö
‚îú‚îÄ‚îÄ ml_models.py       # ML –º–æ–¥–µ–ª—ñ —Ç–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–∏
‚îú‚îÄ‚îÄ main.py           # FastAPI –¥–æ–¥–∞—Ç–æ–∫
‚îú‚îÄ‚îÄ start_service.py  # –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫—É
‚îî‚îÄ‚îÄ models/           # –ó–±–µ—Ä–µ–∂–µ–Ω—ñ –º–æ–¥–µ–ª—ñ (—Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ)
```

### –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
- **FastAPI**: –≤–µ–± —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è API
- **scikit-learn**: ML –∞–ª–≥–æ—Ä–∏—Ç–º–∏
- **pandas**: –æ–±—Ä–æ–±–∫–∞ –¥–∞–Ω–∏—Ö
- **numpy**: –º–∞—Ç–µ–º–∞—Ç–∏—á–Ω—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó
- **uvicorn**: ASGI —Å–µ—Ä–≤–µ—Ä

### –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –º–æ–¥–µ–ª–µ–π
–ù–∞—Ç—Ä–µ–Ω–æ–≤–∞–Ω—ñ –º–æ–¥–µ–ª—ñ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤ –ø–∞–ø—Ü—ñ `models/`:
- `content_model.pkl` - Random Forest –º–æ–¥–µ–ª—å
- `collaborative_model.pkl` - KNN –º–æ–¥–µ–ª—å  
- `user_item_matrix.pkl` - –º–∞—Ç—Ä–∏—Ü—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á-—Ç—Ä–µ–∫
- `scaler.pkl` - –Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ç–æ—Ä —Ñ—ñ—á–µ–π

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç–∏

–°–µ—Ä–≤—ñ—Å –≥–µ–Ω–µ—Ä—É—î –ø–µ—Ä—Å–æ–Ω–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó –Ω–∞ –æ—Å–Ω–æ–≤—ñ:
- ‚úÖ –í–∞—à–∏—Ö —É–ø–æ–¥–æ–±–∞–Ω—å (–ª–∞–π–∫–∏, —Ä–µ–π—Ç–∏–Ω–≥–∏)
- ‚úÖ –ê—É–¥—ñ–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ —É–ª—é–±–ª–µ–Ω–∏—Ö —Ç—Ä–µ–∫—ñ–≤
- ‚úÖ –ü–æ–≤–µ–¥—ñ–Ω–∫–∏ —Å—Ö–æ–∂–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- ‚úÖ –ö–æ–º–±—ñ–Ω–∞—Ü—ñ—ó —Ä—ñ–∑–Ω–∏—Ö –ø—ñ–¥—Ö–æ–¥—ñ–≤ ML

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó —Å—Ç–∞—é—Ç—å —Ç–æ—á–Ω—ñ—à–∏–º–∏ –∑ —á–∞—Å–æ–º, –∫–æ–ª–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –¥–æ–¥–∞—î –±—ñ–ª—å—à–µ –≤–∑–∞—î–º–æ–¥—ñ–π!** üöÄ 